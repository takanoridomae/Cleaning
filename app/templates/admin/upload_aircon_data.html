{% extends "base.html" %}

{% block title %}エアコンデータアップロード{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h2>エアコンデータアップロード</h2>
            
            <div class="alert alert-info">
                <strong>現在のエアコン登録数:</strong> {{ current_count }}件
            </div>

            <div class="alert alert-warning">
                <strong>注意事項:</strong>
                <ul>
                    <li>JSONファイルのみアップロード可能です</li>
                    <li>重複データは自動的に更新されます</li>
                    <li>アップロード前に必ずバックアップを取得してください</li>
                </ul>
            </div>

            <!-- メインのアップロードフォーム -->
            <div style="border: 2px solid #007bff; padding: 20px; border-radius: 10px; background-color: #f8f9fa;">
                <h4>ファイルアップロード</h4>
                <form method="POST" enctype="multipart/form-data">
                    <table>
                        <tr>
                            <td style="padding: 10px;">
                                <strong>ファイル選択:</strong>
                            </td>
                            <td style="padding: 10px;">
                                <input type="file" 
                                       name="aircon_file" 
                                       accept=".json" 
                                       required
                                       style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 300px;">
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td style="padding: 10px;">
                                <button type="submit" 
                                        style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
                                    📤 アップロード実行
                                </button>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>

            <!-- 代替フォーム -->
            <div style="margin-top: 20px; border: 1px solid #28a745; padding: 15px; border-radius: 5px;">
                <h5>代替フォーム（シンプル版）</h5>
                <form method="POST" enctype="multipart/form-data">
                    <p>
                        <label>ファイル選択:</label><br>
                        <input type="file" name="aircon_file" accept=".json" required>
                    </p>
                    <p>
                        <input type="submit" value="アップロード" style="background-color: #28a745; color: white; padding: 8px 16px; border: none; border-radius: 3px;">
                    </p>
                </form>
            </div>

            <!-- HTML5基本フォーム -->
            <div style="margin-top: 20px; border: 1px solid #ffc107; padding: 15px; border-radius: 5px;">
                <h5>HTML5基本フォーム</h5>
                <form method="POST" enctype="multipart/form-data">
                    ファイル: <input type="file" name="aircon_file" accept=".json" required><br><br>
                    <input type="submit" value="送信">
                </form>
            </div>

            <div style="margin-top: 20px;">
                <h5>対象ファイル情報</h5>
                <ul>
                    <li><strong>ファイル名:</strong> aircon_export_20250628_210003.json</li>
                    <li><strong>データ件数:</strong> 114件</li>
                    <li><strong>ファイルサイズ:</strong> 約47KB</li>
                </ul>
            </div>

            <div style="margin-top: 20px;">
                <a href="{{ url_for('main.index') }}" style="background-color: #6c757d; color: white; padding: 8px 16px; text-decoration: none; border-radius: 3px;">
                    ← ダッシュボードに戻る
                </a>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('ページが読み込まれました');
    
    // すべてのファイル入力要素を取得
    const fileInputs = document.querySelectorAll('input[type="file"]');
    console.log('ファイル入力要素数:', fileInputs.length);
    
    fileInputs.forEach((input, index) => {
        console.log(`ファイル入力${index + 1}:`, input);
        
        input.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                console.log('選択されたファイル:', file.name);
                alert(`ファイルが選択されました: ${file.name}`);
            }
        });
    });
});
</script>
{% endblock %} 