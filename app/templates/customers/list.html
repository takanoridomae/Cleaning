{% extends 'base.html' %}

{% block title %}お客様一覧 - エアコンクリーニング完了報告書システム{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h2">お客様一覧</h1>
  <a href="{{ url_for('customers.create') }}" class="btn btn-primary">
    <i class="bi bi-plus-circle me-1"></i>新規お客様登録
  </a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>お客様名</th>
            <th>会社名</th>
            {% if current_user.can_view_sensitive_info() %}
            <th>電話番号</th>
            {% endif %}
            <th>メールアドレス</th>
            {% if current_user.can_view_sensitive_info() %}
            <th>住所</th>
            {% endif %}
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          {% for customer in customers %}
          <tr>
            <td>{{ customer.name }}</td>
            <td>{{ customer.company_name }}</td>
            {% if current_user.can_view_sensitive_info() %}
            <td>{{ customer.phone }}</td>
            {% endif %}
            <td>{{ customer.email }}</td>
            {% if current_user.can_view_sensitive_info() %}
            <td>{{ customer.address }}</td>
            {% endif %}
            <td>
              <a href="{{ url_for('customers.edit', id=customer.id) }}" class="btn btn-sm btn-outline-primary me-1">
                <i class="bi bi-pencil"></i> 編集
              </a>
              <a href="#" class="btn btn-sm btn-outline-danger" 
                 onclick="if(confirm('このお客様を削除してもよろしいですか？この操作は元に戻せません。')) { 
                   window.location.href='{{ url_for('customers.delete', id=customer.id) }}'; 
                 } return false;">
                <i class="bi bi-trash"></i> 削除
              </a>
            </td>
          </tr>
          {% else %}
          <tr>
            {% if current_user.can_view_sensitive_info() %}
            <td colspan="6" class="text-center py-4">
            {% else %}
            <td colspan="4" class="text-center py-4">
            {% endif %}
              <div class="text-muted mb-3">
                <i class="bi bi-info-circle fs-4"></i>
                <p class="mt-2">登録されているお客様はいません</p>
              </div>
              <a href="{{ url_for('customers.create') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-1"></i>新規お客様登録
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %} 